   1                             		.file	"uart.c"
   2                             		.section P,"ax"
   3                             	.Ltext0:
   4                             		.global	_uart9_init
   6                             	_uart9_init:
   7                             	.LFB0:
   8                             		.file 1 "../src/uart/uart.c"
   1:../src/uart/uart.c **** /*******************************************************************************
   2:../src/uart/uart.c **** * Autor			:Lebansais yo & Leconte Micki
   3:../src/uart/uart.c **** *
   4:../src/uart/uart.c **** * File Name		: uart.c
   5:../src/uart/uart.c **** * Version 		: 1
   6:../src/uart/uart.c **** * Device 		: rx210 
   7:../src/uart/uart.c **** * H/W Platform	: 
   8:../src/uart/uart.c **** * Description 	: fichier regroupant les fonctions liées à la com par l'uart
   9:../src/uart/uart.c **** *******************************************************************************/
  10:../src/uart/uart.c **** /*******************************************************************************
  11:../src/uart/uart.c **** * History : DD.MM.YYYY     Version     Description
  12:../src/uart/uart.c **** *           23.11.2016     Ver. 1      first
  13:../src/uart/uart.c **** *                     
  14:../src/uart/uart.c **** *******************************************************************************/
  15:../src/uart/uart.c **** 
  16:../src/uart/uart.c **** /******************************************************************************
  17:../src/uart/uart.c **** Includes   <System Includes> , "Project Includes"
  18:../src/uart/uart.c **** *******************************************************************************/
  19:../src/uart/uart.c **** #include "iodefine.h"
  20:../src/uart/uart.c **** #include "RPBRX210.h"
  21:../src/uart/uart.c **** #include "interrupt_handlers.h"
  22:../src/uart/uart.c **** #include "typedefine.h"
  23:../src/uart/uart.c **** #include "uart.h"
  24:../src/uart/uart.c **** 
  25:../src/uart/uart.c **** /******************************************************************************
  26:../src/uart/uart.c **** Macro definitions
  27:../src/uart/uart.c **** ******************************************************************************/
  28:../src/uart/uart.c **** #define baud_rate 115200
  29:../src/uart/uart.c **** #define mtclk	32000000
  30:../src/uart/uart.c **** 
  31:../src/uart/uart.c **** /*****************************************************************************
  32:../src/uart/uart.c **** Private global variables and function
  33:../src/uart/uart.c **** ****************************************************************************/
  34:../src/uart/uart.c **** 
  35:../src/uart/uart.c **** /******************************************************************************
  36:../src/uart/uart.c **** * Function Name	:uart9_init 
  37:../src/uart/uart.c **** * Description	: initialise la communication de l'uart n°9 a 115200 bauds 
  38:../src/uart/uart.c **** * Arguments     : none
  39:../src/uart/uart.c **** * Return value	: none
  40:../src/uart/uart.c **** *******************************************************************************/
  41:../src/uart/uart.c **** 
  42:../src/uart/uart.c **** void uart9_init(void)
  43:../src/uart/uart.c **** {
   9                             		.loc 1 43 0
  10 0000 6E 6B                   		pushm	r6-r11
  11                             	.LCFI0:
  12 0002 EF 06                   		mov.L	r0, r6
  13                             	.LCFI1:
  44:../src/uart/uart.c **** 	SYSTEM.PRCR.WORD=0xA502;	//unlock protection
  14                             		.loc 1 44 0
  15 0004 FB AE 00 00 08          		mov.L	#0x80000, r10
  16 0009 FA A9 FF 01 02 A5       		mov.W	#0xffffa502, 1022[r10]
  45:../src/uart/uart.c **** 	SYSTEM.MSTPCRA.BIT.ACSE=0;	//clear ACSE bit (all-module clock stop mode enable
  17                             		.loc 1 45 0
  18 000f FB AE 00 00 08          		mov.L	#0x80000, r10
  19 0014 ED AB 04                		mov.L	16[r10], r11
  20 0017 74 2B FF FF FF 7F       		and	#0x7fffffff, r11
  21 001d E7 AB 04                		mov.L	r11, 16[r10]
  46:../src/uart/uart.c **** 	MSTP(SCI9)=0;			// cancel state of SCI9 peripheral to enable writing
  22                             		.loc 1 46 0
  23 0020 FB AE 00 00 08          		mov.L	#0x80000, r10
  24 0025 ED AB 06                		mov.L	24[r10], r11
  25 0028 74 2B FF FF FF FB       		and	#0xfbffffff, r11
  26 002e E7 AB 06                		mov.L	r11, 24[r10]
  47:../src/uart/uart.c **** 	SYSTEM.PRCR.WORD=0xA500;	// relocking
  27                             		.loc 1 47 0
  28 0031 FB AE 00 00 08          		mov.L	#0x80000, r10
  29 0036 FA A9 FF 01 00 A5       		mov.W	#0xffffa500, 1022[r10]
  48:../src/uart/uart.c **** 
  49:../src/uart/uart.c **** 	SCI9.SCR.BYTE=0x00;		// unable TIE, RXI, TX, RX and set cke to internal
  30                             		.loc 1 49 0
  31 003c FB AE 20 A1 08          		mov.L	#0x8a120, r10
  32 0041 F9 A4 02 00             		mov.B	#0, 2[r10]
  50:../src/uart/uart.c **** 	
  51:../src/uart/uart.c **** 	SCI9.SIMR1.BIT.IICM=0;		//clear to use uart
  33                             		.loc 1 51 0
  34 0045 FB AE 20 A1 08          		mov.L	#0x8a120, r10
  35 004a CD AB 09                		mov.B	9[r10], r11
  36 004d 75 2B FE                		and	#-2, r11
  37 0050 C7 AB 09                		mov.B	r11, 9[r10]
  52:../src/uart/uart.c **** 	SCI9.SPMR.BIT.CKPOL=0;		// clock polarity not invert
  38                             		.loc 1 52 0
  39 0053 FB AE 20 A1 08          		mov.L	#0x8a120, r10
  40 0058 CD AB 0D                		mov.B	13[r10], r11
  41 005b 75 2B BF                		and	#0xffffffbf, r11
  42 005e C7 AB 0D                		mov.B	r11, 13[r10]
  53:../src/uart/uart.c **** 	SCI9.SPMR.BIT.CKPH=0;		// clock phase not invert
  43                             		.loc 1 53 0
  44 0061 FB AE 20 A1 08          		mov.L	#0x8a120, r10
  45 0066 CD AB 0D                		mov.B	13[r10], r11
  46 0069 75 2B 7F                		and	#0x7f, r11
  47 006c C7 AB 0D                		mov.B	r11, 13[r10]
  54:../src/uart/uart.c **** 	SCI9.SMR.BYTE=0x00;		//b[0:1] =0b00 -> pclk/1
  48                             		.loc 1 54 0
  49 006f FB AE 20 A1 08          		mov.L	#0x8a120, r10
  50 0074 F8 A4 00                		mov.B	#0, [r10]
  55:../src/uart/uart.c **** 					//b2 no multiprocess mode
  56:../src/uart/uart.c **** 					//b3 1 stop bit
  57:../src/uart/uart.c **** 					//b4,b5 no parity
  58:../src/uart/uart.c **** 					//b6 8 bits data
  59:../src/uart/uart.c **** 					//b7 asynchrone mode
  60:../src/uart/uart.c **** 	SCI9.SCMR.BYTE=0xFC;		//b0 serial communication interface mode
  51                             		.loc 1 60 0
  52 0077 FB AE 20 A1 08          		mov.L	#0x8a120, r10
  53 007c F9 A4 06 FC             		mov.B	#-4, 6[r10]
  61:../src/uart/uart.c **** 					//b1 should be xrite at 1
  62:../src/uart/uart.c **** 					//b2 no invert data 
  63:../src/uart/uart.c **** 					//b3 MSB send first
  64:../src/uart/uart.c **** 					//b[4:6] should be write at 1
  65:../src/uart/uart.c **** 					// BCP2 =1 to have clock diviser 32
  66:../src/uart/uart.c **** 	SCI9.BRR=0x10;			// bps = 115200
  54                             		.loc 1 66 0
  55 0080 FB AE 20 A1 08          		mov.L	#0x8a120, r10
  56 0085 F9 A4 01 10             		mov.B	#16, 1[r10]
  67:../src/uart/uart.c **** 		
  68:../src/uart/uart.c **** 	
  69:../src/uart/uart.c **** 
  70:../src/uart/uart.c **** }
  57                             		.loc 1 70 0
  58 0089 3F 6B 06                		rtsd	#24, r6-r11
  59                             	.LFE0:
 107                             	.Letext0:
 108                             		.file 2 "C:\\Users\\Mickael Leconte\\Documents\\GitHub\\CDF2017\\rx210\\src/iodefine.h"

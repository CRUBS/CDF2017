   1                             		.file	"pwm_asser_RX210.c"
   2                             		.section P,"ax"
   3                             	.Ltext0:
   4                             		.global	_PWM1_init
   6                             	_PWM1_init:
   7                             	.LFB0:
   8                             		.file 1 "../src/pwm_asser_RX210.c"
   1:../src/pwm_asser_RX210.c **** /* Description du projet
   2:../src/pwm_asser_RX210.c ****    15/11/2016
   3:../src/pwm_asser_RX210.c ****    autor : leconte mickael
   4:../src/pwm_asser_RX210.c **** */
   5:../src/pwm_asser_RX210.c **** 
   6:../src/pwm_asser_RX210.c **** #include "pwm_asser_RX210.h"
   7:../src/pwm_asser_RX210.c **** 
   8:../src/pwm_asser_RX210.c **** #include "iodefine.h"
   9:../src/pwm_asser_RX210.c **** #include "RPBRX210.h"
  10:../src/pwm_asser_RX210.c **** #include "typedefine.h"
  11:../src/pwm_asser_RX210.c **** 
  12:../src/pwm_asser_RX210.c **** 
  13:../src/pwm_asser_RX210.c **** // function which initialyze the PWM of motor driver
  14:../src/pwm_asser_RX210.c **** // it take a parameter which is the frequencie (between 0x0000 & 0xFFFF) of mcu speed
  15:../src/pwm_asser_RX210.c **** void PWM1_init( int frequence){
   9                             		.loc 1 15 0
  10 0000 6E 6B                   		pushm	r6-r11
  11                             	.LCFI0:
  12 0002 71 06 FC                		add	#-4, r0, r6
  13                             	.LCFI1:
  14 0005 EF 60                   		mov.L	r6, r0
  15                             	.LCFI2:
  16 0007 E3 61                   		mov.L	r1, [r6]
  16:../src/pwm_asser_RX210.c **** 	MTU3.TCR.BYTE=0x48; // CCLR[2,0]=000 : cleaned by TGRA
  17                             		.loc 1 16 0
  18 0009 FB AE 00 86 08          		mov.L	#0x88600, r10
  19 000e F8 A4 48                		mov.B	#0x48, [r10]
  17:../src/pwm_asser_RX210.c **** 						// CKEG[1,0]=00  : count on raise front
  18:../src/pwm_asser_RX210.c **** 						// TPSC[2,0]=000 : clk/1
  19:../src/pwm_asser_RX210.c **** 	MTU3.TIORH.BYTE=0x25;	// TGRA down and TGRB up the output signal
  20                             		.loc 1 19 0
  21 0011 FB AE 00 86 08          		mov.L	#0x88600, r10
  22 0016 F9 A4 04 25             		mov.B	#37, 4[r10]
  20:../src/pwm_asser_RX210.c **** 	MTU3.TMDR.BYTE=0x02; //MD[3,0]=0010 : pwm mode 1
  23                             		.loc 1 20 0
  24 001a FB AE 00 86 08          		mov.L	#0x88600, r10
  25 001f F9 A4 02 02             		mov.B	#2, 2[r10]
  21:../src/pwm_asser_RX210.c **** 	MTU3.TGRA=frequence; // used as the TCNT clearing source
  26                             		.loc 1 21 0
  27 0023 FB AE 00 86 08          		mov.L	#0x88600, r10
  28 0028 EC 6B                   		mov.L	[r6], r11
  29 002a D7 AB 0C                		mov.W	r11, 24[r10]
  22:../src/pwm_asser_RX210.c **** }
  30                             		.loc 1 22 0
  31 002d 3F 6B 07                		rtsd	#28, r6-r11
  32                             	.LFE0:
  34                             		.global	_PWM2_init
  36                             	_PWM2_init:
  37                             	.LFB1:
  23:../src/pwm_asser_RX210.c **** 
  24:../src/pwm_asser_RX210.c **** void PWM2_init(int frequence){
  38                             		.loc 1 24 0
  39 0030 6E 6B                   		pushm	r6-r11
  40                             	.LCFI3:
  41 0032 71 06 FC                		add	#-4, r0, r6
  42                             	.LCFI4:
  43 0035 EF 60                   		mov.L	r6, r0
  44                             	.LCFI5:
  45 0037 E3 61                   		mov.L	r1, [r6]
  25:../src/pwm_asser_RX210.c **** 	MTU2.TCR.BYTE=0x48; // CCLR[2,0]=000 : cleaned by TGRA
  46                             		.loc 1 25 0
  47 0039 FB AE 92 86 08          		mov.L	#0x88692, r10
  48 003e FA A4 6E 01 48          		mov.B	#0x48, 366[r10]
  26:../src/pwm_asser_RX210.c **** 						// CKEG[1,0]=00  : count on raise front
  27:../src/pwm_asser_RX210.c **** 						// TPSC[2,0]=000 : clk/1
  28:../src/pwm_asser_RX210.c **** 	MTU2.TIOR.BYTE=0x25; 	// TGRA reinitialyse to 0 and TGRB put output at 1
  49                             		.loc 1 28 0
  50 0043 FB AE 92 86 08          		mov.L	#0x88692, r10
  51 0048 FA A4 70 01 25          		mov.B	#37, 368[r10]
  29:../src/pwm_asser_RX210.c **** 	MTU2.TMDR.BYTE=0x02; //MD[3,0]=0010 : pwm mode 1
  52                             		.loc 1 29 0
  53 004d FB AE 92 86 08          		mov.L	#0x88692, r10
  54 0052 FA A4 6F 01 02          		mov.B	#2, 367[r10]
  30:../src/pwm_asser_RX210.c **** 	MTU2.TGRA=frequence; // used as the TCNT clearing source
  55                             		.loc 1 30 0
  56 0057 FB AE 92 86 08          		mov.L	#0x88692, r10
  57 005c EC 6B                   		mov.L	[r6], r11
  58 005e D7 AB BB                		mov.W	r11, 374[r10]
  31:../src/pwm_asser_RX210.c **** }
  59                             		.loc 1 31 0
  60 0061 3F 6B 07                		rtsd	#28, r6-r11
  61                             	.LFE1:
  63                             		.global	_start_pwm1
  65                             	_start_pwm1:
  66                             	.LFB2:
  32:../src/pwm_asser_RX210.c **** 
  33:../src/pwm_asser_RX210.c **** // function to start the pwm
  34:../src/pwm_asser_RX210.c **** void start_pwm1(int valeur)
  35:../src/pwm_asser_RX210.c **** {
  67                             		.loc 1 35 0
  68 0064 6E 6B                   		pushm	r6-r11
  69                             	.LCFI6:
  70 0066 71 06 FC                		add	#-4, r0, r6
  71                             	.LCFI7:
  72 0069 EF 60                   		mov.L	r6, r0
  73                             	.LCFI8:
  74 006b E3 61                   		mov.L	r1, [r6]
  36:../src/pwm_asser_RX210.c **** 	MTU.TSTR.BIT.CST3=0;//dÃ©sactive la pwm
  75                             		.loc 1 36 0
  76 006d FB AE 0A 86 08          		mov.L	#0x8860a, r10
  77 0072 CD AB 76                		mov.B	118[r10], r11
  78 0075 75 2B BF                		and	#0xffffffbf, r11
  79 0078 C7 AB 76                		mov.B	r11, 118[r10]
  37:../src/pwm_asser_RX210.c **** 	if (valeur > MTU3.TGRA) valeur = MTU3.TGRA ; // tcheck if the value of 'valeur' is ok
  80                             		.loc 1 37 0
  81 007b FB AE 00 86 08          		mov.L	#0x88600, r10
  82 0080 DD AA 0C                		mov.W	24[r10], r10
  83 0083 5F AB                   		movu.W	r10, r11
  84 0085 EC 6A                   		mov.L	[r6], r10
  85 0087 47 AB                   		cmp	r10, r11
  86 0089 28 0E                   		bge	.L4
  87                             		.loc 1 37 0 is_stmt 0 discriminator 1
  88 008b FB AE 00 86 08          		mov.L	#0x88600, r10
  89 0090 DD AA 0C                		mov.W	24[r10], r10
  90 0093 5F AA                   		movu.W	r10, r10
  91 0095 E3 6A                   		mov.L	r10, [r6]
  92                             	.L4:
  38:../src/pwm_asser_RX210.c **** 	MTU3.TGRB = valeur; // put valeur in TGRB <=> %of pwm
  93                             		.loc 1 38 0 is_stmt 1
  94 0097 FB AE 00 86 08          		mov.L	#0x88600, r10
  95 009c EC 6B                   		mov.L	[r6], r11
  96 009e D7 AB 0D                		mov.W	r11, 26[r10]
  39:../src/pwm_asser_RX210.c **** 	MTU.TSTR.BIT.CST3=1; // active la pwm
  97                             		.loc 1 39 0
  98 00a1 FB AE 0A 86 08          		mov.L	#0x8860a, r10
  99 00a6 CD AB 76                		mov.B	118[r10], r11
 100 00a9 75 3B 40                		or	#64, r11
 101 00ac C7 AB 76                		mov.B	r11, 118[r10]
  40:../src/pwm_asser_RX210.c **** }
 102                             		.loc 1 40 0
 103 00af 3F 6B 07                		rtsd	#28, r6-r11
 104                             	.LFE2:
 106                             		.global	_start_pwm2
 108                             	_start_pwm2:
 109                             	.LFB3:
  41:../src/pwm_asser_RX210.c **** 
  42:../src/pwm_asser_RX210.c **** 
  43:../src/pwm_asser_RX210.c **** void start_pwm2(int valeur)
  44:../src/pwm_asser_RX210.c **** {
 110                             		.loc 1 44 0
 111 00b2 6E 6B                   		pushm	r6-r11
 112                             	.LCFI9:
 113 00b4 71 06 FC                		add	#-4, r0, r6
 114                             	.LCFI10:
 115 00b7 EF 60                   		mov.L	r6, r0
 116                             	.LCFI11:
 117 00b9 E3 61                   		mov.L	r1, [r6]
  45:../src/pwm_asser_RX210.c **** //	TPU3.TGRB=0x0F;
  46:../src/pwm_asser_RX210.c **** 	MTU.TSTR.BIT.CST2=0;
 118                             		.loc 1 46 0
 119 00bb FB AE 0A 86 08          		mov.L	#0x8860a, r10
 120 00c0 CD AB 76                		mov.B	118[r10], r11
 121 00c3 75 2B FB                		and	#-5, r11
 122 00c6 C7 AB 76                		mov.B	r11, 118[r10]
  47:../src/pwm_asser_RX210.c **** 
  48:../src/pwm_asser_RX210.c **** }
 123                             		.loc 1 48 0
 124 00c9 3F 6B 07                		rtsd	#28, r6-r11
 125                             	.LFE3:
 277                             	.Letext0:
 278                             		.file 2 "../src/iodefine.h"
